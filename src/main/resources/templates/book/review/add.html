<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>レビュー投稿 | 読書記録管理システム</title>
	<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
	<link th:href="@{/css/style.css}" rel="stylesheet">
	<style>
		/* 星評価スタイル */
		.star-rating {
			direction: rtl;
			font-size: 2rem;
			unicode-bidi: bidi-override;
			display: inline-flex;
		}

		.star-rating input[type="radio"] {
			display: none;
		}

		.star-rating label {
			color: #ccc;
			cursor: pointer;
		}

		.star-rating input[type="radio"]:checked~label {
			color: #f7d106;
		}

		.star-rating label:hover,
		.star-rating label:hover~label {
			color: #f7d106;
		}
	</style>
</head>

<body>

	<!-- ▼ Header ▼ -->
	<header class="bg-dark text-white py-3 mb-4">
		<div class="container">
			<div class="d-flex align-items-center position-relative">
				<h1 class="text-center flex-grow-1 m-0 fs-3">読書記録管理システム</h1>
				<div class="d-none d-md-block">
					<span th:text="${username}">アカウント名</span>さん、ようこそ
					<a th:href="@{/logout}" class="btn btn-outline-light btn-sm">ログアウト</a>
				</div>
			</div>

			<nav class="mt-3">
				<ul class="nav justify-content-center">
					<li class="nav-item"><a th:href="@{/home}" class="nav-link px-3 text-white">トップ</a></li>
					<li class="nav-item"><a th:href="@{/book/search}" class="nav-link px-3 text-white">本を探す</a></li>
					<li class="nav-item"><a th:href="@{/book/list}" class="nav-link px-3 text-white">マイ本棚</a></li>
					<li class="nav-item"><a href="/book/recommend" class="nav-link px-3 text-white">あなたへのおすすめ</a></li>
					<li class="nav-item"><a href="/book/review/list" class="nav-link px-3 text-white">新着レビュー</a></li>
					<li class="nav-item"><a href="/book/ranking" class="nav-link px-3 text-white">ランキング</a></li>
				</ul>
			</nav>
		</div>
	</header>

	<!-- ▼ Main Content ▼ -->
	<div class="container">

		<h2 class="mb-4 text-center">レビューを投稿する</h2>

		<!-- ▼ 入力フォーム ▼ -->
		<form th:action="@{/book/review/add}" th:object="${reviewForm}" method="post" class="mx-auto"
			style="max-width: 700px;">

			<!-- グローバルエラー表示 -->
			<div th:if="${#fields.hasGlobalErrors()}" class="error-message mb-3">
				<p th:each="err : ${#fields.globalErrors}" th:text="${err}"></p>
			</div>

			<!-- hidden input :userBookId,bookId -->
			<input type="hidden" th:field="*{userBookId}" />
			<input type="hidden" th:field="*{bookId}" />

			<!-- 星採点 -->
			<div class="mb-4">
				<label class="form-label fw-bold">評価（必須）</label>
				<div class="star-rating">
					<input type="radio" th:field="*{rating}" id="rating5" value="5"><label for="rating5">★</label>
					<input type="radio" th:field="*{rating}" id="rating4" value="4"><label for="rating4">★</label>
					<input type="radio" th:field="*{rating}" id="rating3" value="3"><label for="rating3">★</label>
					<input type="radio" th:field="*{rating}" id="rating2" value="2"><label for="rating2">★</label>
					<input type="radio" th:field="*{rating}" id="rating1" value="1"><label for="rating1">★</label>
				</div>
				<div th:if="${#fields.hasErrors('rating')}" th:errors="*{rating}" class="error-message"></div>
			</div>

			<!-- レビュー本文 -->
			<div class="mb-4">
				<label for="comment" class="form-label fw-bold">レビュー内容（必須）</label>
				<textarea th:field="*{comment}" id="comment" rows="6" class="form-control"
					placeholder="レビュー内容を入力してください"></textarea>
				<div th:if="${#fields.hasErrors('comment')}" th:errors="*{comment}" class="error-message"></div>
			</div>

			<!-- ボタン -->
			<div class="text-center mt-4">
				<button type="submit" class="btn btn-primary px-4">レビューを投稿する</button>
				<a th:href="@{/book/review/detail-list(bookId=${reviewForm.bookId})}"
					class="btn btn-secondary px-4 ms-2">キャンセル</a>
			</div>

		</form>
	</div>

	<!-- ▼ Footer ▼ -->
	<footer class="mt-5 py-3 bg-dark text-center text-white">
		© 読書記録管理システム
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>